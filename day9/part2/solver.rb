s=[*$<]*'';s=(s+?9*w=1+(s=~/$/)).tr$/,?9;f=->i{s[i]>?8?0:(s[i]=?9;1+f[i-1]+f[i+1]+f[i-w]+f[i+w])};p (0..w*$.).map{f[_1]}.max(3).inject:*